<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title>[Android] Getting Started</title>
<link rel="stylesheet" href="../../_asciidoc/stylesheets/asciidoc.css" type="text/css" />
<link rel="stylesheet" href="../../_asciidoc/stylesheets/layout2.css" type="text/css" />
<script type="text/javascript" src="../../_asciidoc/javascripts/asciidoc.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
asciidoc.install();
/*]]>*/
</script>
</head>
<body>
<div id="layout-menu-box">
<div id="layout-menu">
  <div>&#187;<a href="../../index.html">首頁</a></div>
  <div>&#187;<a href="../../note/index.html">學習筆記</a></div>
  <div><img src="http://www.gravatar.com/avatar/ca5d67276ca1ff3e5391438d7865ddf2" border="0" /><br/><em>Jeremy Kao</em></div>
  <div>&#187;<a href="http://imsardine.wordpress.com">部落格</a></div>
  <div>&#187;<a href="https://github.com/imsardine">GitHub</a></div>
  <!-- <div id="page-source">&#187;<a href="android-development-start.txt">頁面原始碼</a></div> -->
</div>
</div>
<div id="layout-content-box">
<div id="layout-banner">
  <div id="layout-title">在電梯裡遇見雙胞胎</div>
  <div id="layout-description">腦袋不是用來裝東西，而是用來思考問題的；所以我把懶得記的、記不住的，通通寫在這裡...</div>
</div>
<div id="layout-content">
<div id="header">
<h1>[Android] Getting Started</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>開始之前，必須先把 <a href="android-sdk.html">Android SDK</a>、<a href="../eclipse/eclipse.html">Eclipse</a> + <a href="android-adt.html">ADT</a> 等先安裝好。</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/new_application.png" alt="android-development-start/new_application.png" />
</div>
</div>
<div class="paragraph"><p>建立新專案時要提供：</p></div>
<div class="ulist"><ul>
<li>
<p>
Application Name - 使用者在 <a href="../google-play/google-play.html">Google Play</a> 上會看到的名稱，例如 <code>My First App</code>。
</p>
</li>
<li>
<p>
Project Name - 也就是 Eclipse 專案資料夾的名稱，因此建議不要有空白，例如 <code>MyFirstApp</code>。
</p>
</li>
<li>
<p>
Package Name - 這個 app 的 <em>package namespace</em>，採 <a href="http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html">Java package 的命名規則</a>。由於 package name 在同一支手機裡或 Google Play 上都不能重複，建議將 domain name 顛倒過來做為開頭，例如 <code>com.example.myfirstapp</code>。
</p>
</li>
<li>
<p>
Build SDK - 這跟 compile 時要用的 platform 版本或 Jar 檔有關 。通常這個版號越大越好，當程式執行在新 platform 時才啟用某些功能，不但可以繼續支援舊的 platform，對新的 platform 也可以提供更好的體驗。
</p>
</li>
<li>
<p>
Minimum Required SDK - 這個 app 至少要跑在哪個 <a href="android-api-level.html">API level</a> 版本之上。通常這個版號越小越好，才能支援更多的裝置；除非某些必要的功能（core feature set）在特定版本後才支援。
</p>
</li>
</ul></div>
<div class="paragraph"><p>快速製作適用於不同 <a href="android-density.html">screen density</a> 的 launcher icon：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/launcher_icon.png" alt="android-development-start/launcher_icon.png" />
</div>
</div>
<div class="paragraph"><p>選定一個 <a href="android-activity.html">activity</a> template，並完成一些基本的設定：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/create_activity.png" alt="android-development-start/create_activity.png" />
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/blank_activity.png" alt="android-development-start/blank_activity.png" />
</div>
</div>
<div class="paragraph"><p>一開始就會看到 ADT 提供的 WYSIWYG 開發環境 - Graphical Layout Editor：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/activity_main.png" alt="android-development-start/activity_main.png" />
</div>
</div>
<div class="paragraph"><p>一開始的專案目錄結構如下：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>MyFirstApp/
|-- AndroidManifest.xml <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
|-- proguard-project.txt
|-- project.properties
|-- assets
|-- bin
|-- gen <img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" />
|   `-- com
|       `-- example
|           `-- myfirstapp
|               |-- BuildConfig.java
|               `-- R.java
|-- ic_launcher-web.png
|-- libs
|   `-- android-support-v4.jar
|-- res <img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" />
|   |-- drawable-hdpi <img src="../../_asciidoc/images/icons/callouts/5.png" alt="5" />
|   |   |-- ic_action_search.png
|   |   `-- ic_launcher.png
|   |-- drawable-ldpi
|   |   `-- ic_launcher.png
|   |-- drawable-mdpi
|   |   |-- ic_action_search.png
|   |   `-- ic_launcher.png
|   |-- drawable-xhdpi
|   |   |-- ic_action_search.png
|   |   `-- ic_launcher.png
|   |-- layout <img src="../../_asciidoc/images/icons/callouts/6.png" alt="6" />
|   |   `-- activity_main.xml
|   |-- menu
|   |   `-- activity_main.xml
|   |-- values <img src="../../_asciidoc/images/icons/callouts/7.png" alt="7" />
|   |   |-- dimens.xml
|   |   |-- strings.xml
|   |   `-- styles.xml
|   |-- values-large
|   |   `-- dimens.xml
|   |-- values-v11
|   |   `-- styles.xml
|   `-- values-v14
|       `-- styles.xml
`-- src <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
    `-- com
        `-- example
            `-- myfirstapp
                `-- MainActivity.java</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
所有 app 相關的設定幾乎都是寫在這個 <a href="android-manifest.html">menifest file</a> 裡。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
主要的程式碼都放在 <code>src/</code> 裡，例如 <code>MainActivity.java</code>。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" /></td><td>
編譯過程中自動產生的程式碼都放在 <code>gen/</code> 裡，其中包括最常被提及的 <code>R.java</code>。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" /></td><td>
<code>res/</code> 底下每個資料夾都存放不同型態的 <a href="android-resource.html">app resource</a>，也可以針對不同的情況（螢幕大小、密度、語言、API Level 等）分別做客製化。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/5.png" alt="5" /></td><td>
<code>drawable-xxx</code> 分別存放適用於不同 density 的 drawable object，例如圖檔。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/6.png" alt="6" /></td><td>
UI 的編排存放在 <code>layout/</code> 裡，例如 <code>layout/activity_main.xml</code>。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/7.png" alt="7" /></td><td>
文字、設計（style）則存放在 <code>values/</code> 或 values-xxx` 裡，例如 <code>values/strings.xml</code>。
</td></tr>
</table></div>
<div class="listingblock">
<div class="title"><code>AndroidMenifest.xml</code></div>
<div class="content">
<pre><code>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myfirstapp"
    android:versionCode="1"
    android:versionName="1.0" &gt;

    &lt;uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" /&gt;

    &lt;application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" &gt;
        &lt;activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt; <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
將 activity 註冊成 <a href="android-activity-launcher.html">launcher activity</a>，要被顯示在 home screen，做為 app 的起點。
</td></tr>
</table></div>
<div class="listingblock">
<div class="title"><code>MainActivity.java</code></div>
<div class="content">
<pre><code>package com.example.myfirstapp;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.support.v4.app.NavUtils;

public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main); <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

}</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
載入 <code>res/layout/activity_main.xml</code> 做為這個 activity 的內容。
</td></tr>
</table></div>
<div class="paragraph"><p>在專案上按右鍵，選 Run As &gt; Android Application，就會自動包裝出 debuggable 的 <code>MyFirstApp.apk</code>，並將它安裝到連接的 device 或運行中的 emulator。（如果當時有多個 device/emulator，就會跳出來詢問要採用哪個 device/emulator）</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[2012-08-25 06:45:35 - MyFirstApp] ------------------------------
[2012-08-25 06:45:35 - MyFirstApp] Android Launch!
[2012-08-25 06:45:35 - MyFirstApp] adb is running normally.
[2012-08-25 06:45:35 - MyFirstApp] Performing com.example.myfirstapp.MainActivity activity launch
[2012-08-25 06:45:36 - MyFirstApp] Automatic Target Mode: using device 'HT142TJ06210'
[2012-08-25 06:45:36 - MyFirstApp] Uploading MyFirstApp.apk onto device 'HT142TJ06210'
[2012-08-25 06:45:36 - MyFirstApp] Installing MyFirstApp.apk...
[2012-08-25 06:45:41 - MyFirstApp] Success!
[2012-08-25 06:45:41 - MyFirstApp] Starting activity com.example.myfirstapp.MainActivity on device HT142TJ06210
[2012-08-25 06:45:43 - MyFirstApp] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.example.myfirstapp/.MainActivity }</code></pre>
</div></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/myfirstapp_v0.png" alt="android-development-start/myfirstapp_v0.png" />
</div>
</div>
<div class="paragraph"><p>UI 由階層化的 <code>View</code> (<a href="http://developer.android.com/reference/android/view/View.html"><code>android.view.View</code></a>) 與 <code>ViewGroup</code> (<a href="http://developer.android.com/reference/android/view/ViewGroup.html"><code>android.view.ViewGroup</code></a>) 組成（<code>ViewGroup</code> 繼承自 <code>View</code>）。通常 view 是看得見或可以操作的 <a href="android-widget.html">UI 組件（widget）</a>，而 view group 則是看不見的 view container，負責下層 child view 的 <a href="android-layout.html">layout</a> （反過來說，view container 就是 child view 的 parent view）。最頂層的 view 我們稱做 root view：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/view_hierarchy.png" alt="android-development-start/view_hierarchy.png" />
</div>
<div class="title">Figure 1. （來源：<a href="http://developer.android.com/training/basics/firstapp/building-ui.html">Android Developers</a>）</div>
</div>
<div class="paragraph"><p>這樣的階層關係，可以直接從 <code>activity_main.xml</code> 的內容看出來：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" &gt;

    &lt;TextView <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        android:layout_width="wrap_content" <img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" />
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text="@string/hello_world" <img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" />
        tools:context=".MainActivity" /&gt;   <img src="../../_asciidoc/images/icons/callouts/5.png" alt="5" />

&lt;/RelativeLayout&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<a href="android-layout-relative.html"><code>RelativeLayout</code></a> 就是個 view group，目前裡面只有一個 child view。
<div class="paragraph"><p>其中 <code>android:layout_width</code> 跟 <code>android:layout_height</code> 可以用來設定 view 的大小，這裡的 <code>match_parent</code> 是指寬度或高度要 “填滿” parent view。就這個例子而言，<code>RelativeLayout</code> 本身就是 root view，<code>match_parent</code> 就是要填滿整個螢幕的意思（跟全螢幕 full screen 不同）。</p></div>
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>TextView</code> (<a href="http://developer.android.com/reference/android/widget/TextView.html"><code>android.widget.TextView</code></a>) 就是個 view，用來顯示文字。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" /></td><td>
相對於 <code>match_parent</code> 而這，這裡的 <code>wrap_content</code> 指的是配置 “足以顯示內容“ 的大小即可。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" /></td><td>
文字的內容來自 <code>res/values/strings.xml</code> 裡 <code>hello_world</code> 的定義。
<div class="openblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre><code>&lt;string name="hello_world"&gt;Hello world!&lt;/string&gt;</code></pre>
</div></div>
<div class="paragraph"><p>開頭的 <code>@</code> 表示要參照某個 resource object，以這個例子而言，resource type 是 <code>string</code>，而 resource name 是 <code>hello_world</code>。</p></div>
</div></div>
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/5.png" alt="5" /></td><td>
為什麼要額外用 <code>tools:context</code> 設定 context？這是 <code>RelativeLayout</code> 特有的嗎？
</td></tr>
</table></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/tip.png" alt="Tip" />
</td>
<td class="content">
<div class="paragraph"><p>Android 提供了很多 XML vocabulary 直接跟 view 或 view group 對應。除了 editor 提供自動完成之外，要知道某個 view 支援哪些 attribute，可以查看 reference 的 XML Attributes 跟 Inherited XML Attributes 兩節：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/ref_head.png" alt="android-development-start/ref_head.png" />
</div>
</div>
<div class="paragraph"><p>至於常用的 <code>android:layout_width</code>、<code>android:layout_height</code>、<code>android:layout_weight</code> 則是從 layout parameters 而來，例如 <a href="http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html#lattrs"><code>ViewGroup.LayoutParams</code></a>、<a href="http://developer.android.com/reference/android/widget/LinearLayout.LayoutParams.html#lattrs"><code>LinearLayout.LayoutParams</code></a> 等。</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/xml_attprop.png" alt="android-development-start/xml_attprop.png" />
</div>
</div>
<div class="paragraph"><p>另外 XML attribute name 通常都有對應的 property setter。</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>按下來我們要將 My First App 改寫成下面這個樣子：</p></div>
<div class="paragraph"><p>首先將 root view <code>RelativeLayout</code> 換成 <a href="android-layout-linear.html"><code>LinearLayout</code></a>：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" &gt; <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
用 <code>android:orientation</code> 來決定 child view 的走向。
</td></tr>
</table></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/tip.png" alt="Tip" />
</td>
<td class="content">
<div class="paragraph"><p>本來想用 Graphical Layout Editor (ADT v20 + API 16) 來完成畫面的配置，沒想到把 Plain Text 拖進畫面後就出現 "java.util.LinkedHashMap.eldest()Ljava/util/Map$Entry;" 的錯誤，顯然 WYSIWYG 的開發環境目前還不是很完善。</p></div>
<div class="paragraph"><p>目前可以按照<a href="http://stackoverflow.com/questions/11275754/exception-in-loading-layout-java-util-linkedhashmap-eldestljava-util-mapentr">這裡</a>的說明，在 <code>&lt;EditText&gt;</code> 加上 <code>android:inputType="textNoSuggestions"</code> 的設定暫時避開這個問題，也可以切到 API 15。</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>將 <code>TextView</code> 換成可以輸入文字的 <code>EditText</code> (<a href="http://developer.android.com/reference/android/widget/EditText.html"><code>android.widget.EditText</code></a>)：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    &lt;EditText android:id="@+id/edit_message" <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:hint="@string/edit_message" /&gt; <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />

    &lt;Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/button_send" /&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<code>@</code> 一樣是用來參照某個 resource object，但後面跟著 <code>+</code> 則表示要 “宣告／建立“ 一個 resource ID，之後從程式碼裡才能藉由 <code>R.id.xxx</code> 引用到這個 view。
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/tip.png" alt="Tip" />
</td>
<td class="content">也因為 <code>+</code> 是用來 “宣告／建立“，所以只有第一次提及這個 resource ID 才需要加 <code>+</code>。至於先前的 <code>@string/hello_world</code>，由於是參照 concret resource （例如 string 或 layout 等在 <code>/res</code> 底下有實際的檔案與之對應），所以即便是第一次參照該 resource，也不需要用到 <code>+</code>。</td>
</tr></table>
</div>
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>android_hint</code> 用來設定沒有輸入任何文字時，背影要顯示的提示文字。
<div class="openblock">
<div class="content">
<div class="paragraph"><p>把畫面上會用到的文字都提出成 string resource，方便未來做 localization (L10N)。</p></div>
<div class="paragraph"><p>另外雖然 <code>"@+id/edit_message"</code> 跟 <code>"@string/edit_message"</code> 的 resource name 都是 <code>edit_message</code>，但因為不同 resource type 的 namespace 是分開的，所以不會有衝突。</p></div>
</div></div>
</td></tr>
</table></div>
<div class="paragraph"><p>此時，editor 會警告 <code>@string/edit_message</code> 跟 <code>@string/button_send</code> 都不存在：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/res_not_found.png" alt="android-development-start/res_not_found.png" />
</div>
</div>
<div class="paragraph"><p>只要到 <code>res/values/strings.xml</code> 加以定義即可：（事先把 resource 建立好，編輯 XML 時透過自動完成來選取，會更有感覺）</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;resources&gt;

    &lt;string name="app_name"&gt;My First App&lt;/string&gt;
    &lt;string name="hello_world"&gt;Hello world!&lt;/string&gt;     <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
    &lt;string name="edit_message"&gt;Enter a message&lt;/string&gt; <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
    &lt;string name="button_send"&gt;Send&lt;/string&gt;
    &lt;string name="menu_settings"&gt;Settings&lt;/string&gt;
    &lt;string name="title_activity_main"&gt;MainActivity&lt;/string&gt;

&lt;/resources&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
把 <code>hello_world</code> 拿掉，已經用不到了。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
加上 <code>edit_message</code> 與 <code>button_send</code> 兩個 string resource。
</td></tr>
</table></div>
<div class="paragraph"><p>目前畫面看起來像是：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/myfirstapp_v1.png" alt="android-development-start/myfirstapp_v1.png" />
</div>
</div>
<div class="paragraph"><p>顯然按鈕右側還有一些多餘的空白。透過下面的調整，可以把剩下的位置都分給文字輸入框：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    &lt;EditText android:id="@+id/edit_message"
        android:layout_width="0dp" <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        android:layout_height="wrap_content"
        android:layout_weight="1" <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
        android:hint="@string/edit_message" /&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
Linear layout 支援 weight 的概念，可以用來決定怎麼分配（特定走向）剩餘的空間。由於右側按鈕的 weight 沒有設定，維持預設值是零，所以只要將 <code>EditText</code> 的 <code>android:layout_weight</code> 調整成非零值，就可以分配到所有剩餘的空間。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
為了 layout efficiency，將 <code>android:layout_width</code> 設為 <code>0dp</code>（這裡的 <code>dp</code> 指的是 density-independent pixel）。
<div class="paragraph"><p>如果 <code>layout_width</code> 還是保留原來的 <code>wrap_content</code>，花時間算出來的寬度並不會被採納（做白工），因為最後的寬度是由 "剩餘多少空間" 來決定。</p></div>
</td></tr>
</table></div>
<div class="paragraph"><p>調整過後的畫面：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/myfirstapp_v2.png" alt="android-development-start/myfirstapp_v2.png" />
</div>
</div>
<div class="paragraph"><p>接下來，我們要讓 Send 按鈕被按下時，開出另一個畫面來顯示文字輸入框的內容。</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    &lt;Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/button_send"
        android:onClick="sendMessage" /&gt; <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
用 <code>android:onClick</code> 宣告按鈕被按下時要呼叫 activity 的哪個方法。
</td></tr>
</table></div>
<div class="paragraph"><p>在開始說明 <code>sendMessage()</code> 之前，先建立另一個 <code>DisplayMessageActivity</code>（File &gt; New &gt; Other&#8230; &gt; Android &gt; Android Activity）：</p></div>
<div class="imageblock">
<div class="content">
<img src="android-development-start/activity_display_message.png" alt="android-development-start/activity_display_message.png" />
</div>
</div>
<div class="paragraph"><p>會自動在 <code>AndroidMenifest.xml</code> 加入這個 activity 的宣告：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        &lt;activity
            android:name=".DisplayMessageActivity"
            android:label="@string/title_activity_display_message" &gt;
            &lt;meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value="com.example.myfirstapp.MainActivity" /&gt;
        &lt;/activity&gt;</code></pre>
</div></div>
<div class="paragraph"><p>回到 <code>MainActivity</code> 的 <code>sendMessage()</code>，透過 <a href="android-intent.html">intent</a> 將訊息內容送往 <code>DisplayMessageActivity</code>：</p></div>
<div class="listingblock">
<div class="title"><code>MainActivity</code></div>
<div class="content">
<pre><code>    public final static String EXTRA_MESSAGE = "com.example.myfirstapp.MESSAGE"; <img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" />

    public void sendMessage(View view) { <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />
        EditText edit_message = (EditText)findViewById(R.id.edit_message); <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        String message = edit_message.getText().toString()

        Intent intent = new Intent(this, DisplayMessageActivity.class);    <img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" />
        intent.putExtra(EXTRA_MESSAGE, message); <img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" />
        startActivity(intent);
    }</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
做為 event handler 的 method，其 signature 有一些要求－必須是 <code>public</code>、沒有回傳值（<code>void</code>）、只接受一個型態為 <code>android.view.View</code> 的參數。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>findViewById()</code> 透過 id resource object 取得 view，藉以取得輸入的文字。另外 <code>EditText.getText()</code> 是傳回 <code>Editable</code> (<code>android.text.Editable</code>)，所以才需要再用 <code>toString()</code> 取得字串內容。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/3.png" alt="3" /></td><td>
Intent 可以在不同 app component 之間傳遞資訊；在這裡用來開啟另一個 activity，並挾帶一些資訊。
<div class="openblock">
<div class="content">
<div class="paragraph"><p><code>Intent</code> (<code>android.content.Intent</code>) constructor 的第一個參數是 <a href="android-context.html"><code>Context</code></a> (<code>android.content.Context</code>)，由於 <code>Activity</code> 本身就是 <code>Context</code> 的 subclass，所以直接帶入 <code>this</code> 即可。</p></div>
<div class="paragraph"><p>至於第二個參數則是指定要將這個 intent 傳遞給某個 app component，所以這裡帶入另一個 activity <code>DisplayMessageActivity</code> 的 class。</p></div>
</div></div>
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/4.png" alt="4" /></td><td>
Intent 還可以挾帶 key-value pairs （稱做 extras），然後用 <code>startActivity(intent)</code> 告訴系統你要啟動另一個 activity。
</td></tr>
</table></div>
<div class="paragraph"><p>在 <code>startActivity(intent)</code> 的另一邊，系統負責生成 <code>DisplayMessageActity</code> 的 instance 之後，就會呼叫它的 <code>onCreate()</code>，這裡除了一般初始化的工作之外，也可以取得 intent 的內容：</p></div>
<div class="listingblock">
<div class="title"><code>DisplayMessageActivity</code></div>
<div class="content">
<pre><code>    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Intent intent = getIntent(); <img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" />

        TextView view = new TextView(this); <img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        view.setText(intent.getStringExtra(MainActivity.EXTRA_MESSAGE));
        view.setTextSize(40);

        setContentView(view);
    }</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<code>getIntent()</code> 可以取得啟動這個 activity 的 intent。
</td></tr>
<tr><td><img src="../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
這裡我們不用 XML 來做 layout，而是用程式生成一個 <code>TextView</code> 做為 root view。也因此可以將 <code>activity_display_message.xml</code> 刪除。
</td></tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_延伸閱讀">延伸閱讀</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
<a href="android-opensource.html">從 Open Source App 學習 Android 的開發</a>
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_參考資料">參考資料</h2>
<div class="sectionbody">
<div class="openblock">
<div class="title">官方文件</div>
<div class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/training/index.html">Android Training | Android Developers</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/training/basics/firstapp/index.html">Building Your First App</a>
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/training/basics/firstapp/creating-project.html">Creating an Android Project</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/training/basics/firstapp/running-app.html">Running Your App</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/training/basics/firstapp/building-ui.html">Building a Simple User Interface</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/training/basics/firstapp/starting-activity.html">Starting Another Activity</a>
</p>
</li>
</ul></div>
</li>
<li>
<p>
<a href="http://developer.android.com/reference/android/view/View.html">View | Android Developers</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/reference/android/view/ViewGroup.html">ViewGroup | Android Developers</a>
</p>
</li>
</ul></div>
</div></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2012-12-03 11:07:21 CST
</div>
<div id="footer-badges">
<a href="http://validator.w3.org/check?uri=referer">
  <img style="border:0;width:88px;height:31px"
    src="http://www.w3.org/Icons/valid-xhtml11-blue"
    alt="Valid XHTML 1.1" height="31" width="88" />
</a>
<a href="http://jigsaw.w3.org/css-validator/">
  <img style="border:0;width:88px;height:31px"
    src="http://jigsaw.w3.org/css-validator/images/vcss-blue"
    alt="Valid CSS!" />
</a>
</div>
</div>
</div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://s.gravatar.com/js/gprofiles.js?ver=e"></script>
<script>jQuery(document).ready(function($){ Gravatar.init(); });</script>
</body>
</html>
