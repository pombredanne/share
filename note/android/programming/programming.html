<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title>Android Programming</title>
<link rel="stylesheet" href="../../../_asciidoc/stylesheets/asciidoc.css" type="text/css" />
<link rel="stylesheet" href="../../../_asciidoc/stylesheets/layout2.css" type="text/css" />
<link rel="stylesheet" href="../../../_asciidoc/stylesheets/pygments.css" type="text/css" />
<link rel="Stylesheet" href="http://www.diigo.com/stylesheets/link_rolls_standard.css" title="style_standard" type="text/css" media="screen" />
<script type="text/javascript" src="../../../_asciidoc/javascripts/asciidoc.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
asciidoc.install();
/*]]>*/
</script>
</head>
<body>
<div id="layout-menu-box">
<div id="layout-menu">
  <div><a href="../../../index.html">首頁</a> | <a href="http://www.diigo.com/user/imsardine" target="_blank">閱讀</a> | <a href="../../../note/index.html">筆記</a></div>
  <div>
    <img src="http://www.gravatar.com/avatar/ca5d67276ca1ff3e5391438d7865ddf2" width="32" style="border:none"/>
    <a href="http://imsardine.wordpress.com/" target="_blank"><img src="http://s.wordpress.org/about/images/logos/wordpress-logo-32-blue.png" style="border:none"/></a>
  </div>
  <iframe src="http://githubbadge.appspot.com/badge/imsardine?s=1" style="border: 0;height: 142px;width: 200px;overflow: hidden;" frameBorder=0></iframe>
  <div class="addthis_toolbox addthis_floating_style addthis_counter_style" style="left:140px;top:230px;">
  <a class="addthis_button_facebook_like" fb:like:layout="box_count"></a>
  <a class="addthis_button_tweet" tw:count="vertical"></a>
  <a class="addthis_button_google_plusone" g:plusone:size="tall"></a>
  <a class="addthis_counter"></a>
  </div>
</div>
</div>
<div id="layout-content-box">
<div id="layout-banner">
  <div id="layout-title">在電梯裡遇見雙胞胎</div>
  <div id="layout-description">腦袋不是用來裝東西，而是用來思考問題的；所以我把懶得記的、記不住的，通通寫在這裡... <a href="http://www.diigo.com" onclick="var s=document.createElement('script');s.type='text/javascript';s.src='http://www.diigo.com/javascripts/webtoolbar/diigolet_b_h_b.js';document.body.appendChild(s);return false;"><img style="border:none" alt="Add to Diigo" src="http://www.diigo.com/images/diigo-icon/16.png" /></a></div>
</div>
<div id="layout-content">
<div id="header">
<h1>Android Programming</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_基本概念">基本概念</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Activity 可以用來做某些事，通常提供 UI 跟使用者互動（由層疊的 view 所組成），但不一定要有。
</p>
<div class="ulist"><ul>
<li>
<p>
Activity 是繼承自 <code>android.app.Activity</code> 的類別，而 view 則是繼承自 <code>android.view.View</code> 的類別。（為什麼 <code>Activity</code> 跟 <code>View</code> 都不是 interface??）
</p>
</li>
<li>
<p>
一個應用程式可以有多個 activity，但同時間只有一個 activity 可以跟使用者互動。
</p>
</li>
<li>
<p>
Default activity 怎麼設定??
</p>
</li>
<li>
<p>
最開始，<code>Activity</code> 的 <code>onCreate()</code> 會被呼叫，可以用來初始化 UI，最後透過 <code>setContentView()</code> 設定要顯示的內容。
</p>
</li>
</ul></div>
</li>
<li>
<p>
Context 是應用程式跟系統溝通的媒介（handle）
</p>
<div class="ulist"><ul>
<li>
<p>
Context 是繼承自 <code>android.content.Context</code> 的類別。
</p>
</li>
<li>
<p>
由於 <code>Activity</code> 間接繼承自 <code>Context</code>，所以程式裡有需要 context 的地方，也可以把 <code>this</code> 傳進去。
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/guide/basics/what-is-android.html">What is Android? | Android Developers</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/guide/topics/fundamentals.html">Application Fundamentals | Android Developers</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/guide/topics/fundamentals/activities.html">Activities | Android Developers</a> - Activity Life Cycle
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hello_android">Hello, Android</h2>
<div class="sectionbody">
<div class="paragraph"><p>File &gt; New &gt; Android Project （提供 new project、from existing source 跟 from existing sample）</p></div>
<div class="ulist"><ul>
<li>
<p>
Project Name: <code>HelloAndroid</code>
</p>
</li>
<li>
<p>
Build Target: 依據哪個 Android platform library 做程式碼的編譯而言。
</p>
<div class="ulist"><ul>
<li>
<p>
Android 應用程式有 forward-compatible 的特性（也就是說 Android platform 本身有 backward-compatible 的特性），所以該應用程式可以跑在比編譯時較新的 platform 上。
</p>
</li>
<li>
<p>
Compile your application against the lowest version you want to support, but test it against higher versions that you intend the application to run on.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Application Name: 使用者看到的應用程式名稱，例如 <code>Hello, Android</code>。
</p>
</li>
<li>
<p>
Package Name: <code>com.example.helloandroid</code>
</p>
</li>
<li>
<p>
Create Activity: <code>HelloAndroidActivity</code> (後面加 <code>Activity</code> 好像有點多餘??)
</p>
</li>
<li>
<p>
Minimum SDK: 要跑這個應用程式至少的 API level，通常跟 Build Target 一樣。
</p>
</li>
<li>
<p>
Create a Test Project
</p>
<div class="ulist"><ul>
<li>
<p>
Test Project Name: <code>HelloAndroidTest</code>
</p>
</li>
<li>
<p>
Test Application: <code>HelloAndroidTest</code>
</p>
</li>
<li>
<p>
Test Package: <code>com.example.helloandroid.test</code> (習慣在後面串上 <code>.test</code>)
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>將 <code>HelloAndroidActivity</code> 裡的 <code>setContentView(R.layout.main)</code> 改寫掉：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    // setContentView(R.layout.main);
    TextView tv = new TextView(this); <img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" />
    tv.setText("Hello World, HelloAndroidActivity!");
    setContentView(tv);               <img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" />
}</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
由於 <code>HelloAndroidActivity</code> 間接繼承自 <code>Context</code>，所以可以直接傳入 <code>this</code>。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
整個 activity UI 就是一個 <code>TextView</code>。
</td></tr>
</table></div>
<div class="paragraph"><p>在 project 上點右鍵（不是 <code>HelloAndroidActivity.java</code> 上），選 Run As &gt; Android Application。（如果同時間有多個 emulator 或 Android device 時，會跳出視窗詢問要安裝到哪個 device）</p></div>
<div class="paragraph"><p>觀察檔案目錄結構：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>.
|-- AndroidManifest.xml
|-- assets
|-- gen
|   `-- com
|       `-- example
|           `-- helloandroid
|               `-- R.java
|-- proguard.cfg
|-- project.properties
|-- res
|   |-- drawable-hdpi
|   |   `-- ic_launcher.png
|   |-- drawable-ldpi
|   |   `-- ic_launcher.png
|   |-- drawable-mdpi
|   |   `-- ic_launcher.png
|   |-- layout
|   |   `-- main.xml
|   `-- values
|       `-- strings.xml
`-- src
    `-- com
        `-- example
            `-- helloandroid
                `-- HelloAndroidActivity.java</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><code>AndroidManifest.xml</code></div>
<div class="content">
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.helloandroid"
    android:versionCode="1"
    android:versionName="1.0" &gt;

    &lt;uses-sdk android:minSdkVersion="10" /&gt;

    &lt;application
        android:icon="@drawable/ic_launcher" <img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" />
        android:label="@string/app_name" &gt;   <img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        &lt;activity
            android:name=".HelloAndroidActivity"
            android:label="@string/app_name" &gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;

                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;

&lt;/manifest&gt;</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<code>android:icon</code> 定義應用程式的圖示。<code>@drawable</code> 引用 <code>res/drawable-xxx/</code> 底下的圖檔（忽略副檔名）。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>android:label</code> 定義應用程式的名稱。<code>@string</code> 引用定義在 <code>res/values/strings.xml</code> 裡的 string resource。
</td></tr>
</table></div>
<div class="listingblock">
<div class="title"><code>res/values/strings.xml</code></div>
<div class="content">
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;resources&gt;

    &lt;string name="hello"&gt;Hello World, HelloAndroidActivity!&lt;/string&gt;
    &lt;string name="app_name"&gt;HelloAndroid&lt;/string&gt;

&lt;/resources&gt;</code></pre>
</div></div>
<div class="listingblock">
<div class="title"><code>gen/com/example/helloandroid/R.java</code></div>
<div class="content">
<pre><code>/* AUTO-GENERATED FILE.  DO NOT MODIFY. <img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" />
 *
 * This class was automatically generated by the
 * aapt tool from the resource data it found.  It
 * should not be modified by hand.
 */

package com.example.helloandroid;

public final class R {
    public static final class attr {
    }
    public static final class drawable { <img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" />
        public static final int ic_launcher=0x7f020000;
    }
    public static final class layout {   <img src="../../../_asciidoc/images/icons/callouts/3.png" alt="3" />
        public static final int main=0x7f030000;
    }
    public static final class string {   <img src="../../../_asciidoc/images/icons/callouts/4.png" alt="4" />
        public static final int app_name=0x7f040001;
        public static final int hello=0x7f040000;
    }
}</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<code>R.java</code> 會由 ADT/Ant 自動依 <code>res/</code> 底下的變動做調整。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>R.drawable</code> 參照 <code>res/drawable-xxx/</code> 底下的圖檔。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/3.png" alt="3" /></td><td>
<code>R.layout</code> 參照 <code>res/layout/*.xml</code>。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/4.png" alt="4" /></td><td>
<code>R.string</code> 參照 <code>res/values/strings.xml</code> 裡頭的字串。
</td></tr>
</table></div>
<div class="paragraph"><p>將 <code>res/layout/main.xml</code> 改寫成下面這個樣子：（把外層的 <code>LinerLayout</code> 去掉）</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;TextView xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/textview"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"
  android:text="@string/hello"/&gt;</code></pre>
</div></div>
<div class="paragraph"><p>再將 <code>HelloAndroidActivity</code> 改回原來的樣子，直接拿定義在 <code>res/layout/main.xml</code> 裡的 XML layout 當做 activity UI：</p></div>
<div class="listingblock">
<div class="content">
<pre><code>public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main); <img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" />
}</code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
<code>R.layout.main</code> 直接帶出 <code>res/layout/main.xml</code> 的 XML layout。
</td></tr>
</table></div>
<div class="paragraph"><p>這裡 "XML layout" 是相對於 programmatic layout 的說法。Programmatic layout 的問題在於調整 layout 的成本很高，而且 view 間如果（包覆）關係沒有串聯好，很容易會出狀況。</p></div>
<div class="paragraph"><p>重新執行一次，結果跟第一次的結果一模一樣。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/resources/tutorials/hello-world.html">Hello, World | Android Developers</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notepad_tutorial">Notepad Tutorial</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/resources/tutorials/notepad/index.html">Notepad Tutorial | Android Developers</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_layout_and_widget">Layout and Widget</h2>
<div class="sectionbody">
<div class="paragraph"><p>XML layout file 必須擺在 <code>res/layout</code> 底下。</p></div>
<div class="qlist"><ol>
<li>
<p><em>
TIP: 如果沒有在 <code>res/layout-land</code> 額外提供 landscape layout 的話（相對於 default layout 的說法），版面在設備橫擺時自動做調整。如何將 layout 固定下來不能轉向呢
</em></p>
</li>
</ol></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;TextView xmlns:android="http://schemas.android.com/apk/res/android" <img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" />
  android:id="@+id/textview"          <img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" />
  android:layout_width="fill_parent"  <img src="../../../_asciidoc/images/icons/callouts/3.png" alt="3" />
  android:layout_height="fill_parent"
  android:text="@string/hello"/&gt;      <img src="../../../_asciidoc/images/icons/callouts/4.png" alt="4" /></code></pre>
</div></div>
<div class="colist arabic"><table>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/1.png" alt="1" /></td><td>
每一個 XML element 都表示一個 view。
<div class="ulist"><ul>
<li>
<p>
事實上是 <code>View</code> 類別的名稱，例如這裡的 <code>TextView</code> 就是 <code>android.widget.TextView</code>。也可以是自訂的類別，但如果 <code>View</code> 類別所屬的套件不是 <code>android.widget</code> 呢??
</p>
</li>
<li>
<p>
其中 <code>xmlns:android</code> 宣告 XML namespace。
</p>
</li>
</ul></div>
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/2.png" alt="2" /></td><td>
<code>android:id</code> 搭配 <code>@+id</code> 的語法，給定一個可以從程式碼引用到這個 view 的 ID。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/3.png" alt="3" /></td><td>
<code>android:layout_width</code> 跟 <code>android:layout_height</code> 分別定義這個 view 要分配到多少 "剩餘的" 寬度跟高度。
</td></tr>
<tr><td><img src="../../../_asciidoc/images/icons/callouts/4.png" alt="4" /></td><td>
<code>@string</code> 引用定義在 <code>res/values/strings.xml</code> 裡的 string resource。
</td></tr>
</table></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/resources/tutorials/views/index.html">Hello, Views | Android Developers</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resource_跟_i18n">Resource 跟 i18n</h2>
<div class="sectionbody">
<div class="paragraph"><p>Resource 是 non-code assets，包括 layout file、圖像、聲音、localized string 等。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://developer.android.com/guide/topics/resources/index.html">Application Resources | Android Developers</a>
</p>
</li>
<li>
<p>
<a href="http://developer.android.com/resources/tutorials/localization/index.html">Hello, L10N | Android Developers</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'imsardine'; // required: replace example with your forum shortname
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2012-12-25 23:28:38 CST
</div>
</div>
</div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://s.gravatar.com/js/gprofiles.js?ver=e"></script>
<script>jQuery(document).ready(function($){ Gravatar.init(); });</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50d9b63d0e6d1b63"></script>
</body>
</html>
