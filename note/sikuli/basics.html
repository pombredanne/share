<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title>SIKULI Basics - 在電梯裡遇見雙胞胎 | 傑洛米 Jeremy</title>
<link rel="stylesheet" href="../../_asciidoc/stylesheets/asciidoc.css" type="text/css" />
<link rel="stylesheet" href="../../_asciidoc/stylesheets/layout2.css" type="text/css" />
<link rel="stylesheet" href="../../_asciidoc/stylesheets/pygments.css" type="text/css" />
<!--link rel="Stylesheet" href="http://www.diigo.com/stylesheets/link_rolls_standard.css" title="style_standard" type="text/css" media="screen" /-->
<script type="text/javascript" src="../../_asciidoc/javascripts/asciidoc.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
asciidoc.install();
/*]]>*/
</script>
</head>
<body>
<div id="layout-menu-box">
<div id="layout-menu">
  <div><a href="https://www.facebook.com/jeremy.kao.92" target="_blank">Jeremy Kao - 傑洛米·高</a></div>
  <div><a href="../../index.html">首頁</a> | <a href="http://www.diigo.com/user/imsardine" target="_blank">閱讀</a> | <a href="../../note/index.html">筆記</a></div>
  <div>
    <img src="http://www.gravatar.com/avatar/ca5d67276ca1ff3e5391438d7865ddf2" width="32" style="border:none"/>
    <a href="http://imsardine.wordpress.com/" target="_blank"><img src="http://s.wordpress.org/about/images/logos/wordpress-logo-32-blue.png" style="border:none"/></a>
  </div>
  <iframe src="http://githubbadge.appspot.com/badge/imsardine?s=1" style="border: 0;height: 142px;width: 200px;overflow: hidden;" frameBorder=0></iframe>
  <!--div class="addthis_toolbox addthis_floating_style addthis_counter_style" style="left:140px;top:230px;">
  <a class="addthis_button_facebook_like" fb:like:layout="box_count"></a>
  <a class="addthis_button_tweet" tw:count="vertical"></a>
  <a class="addthis_button_google_plusone" g:plusone:size="tall"></a>
  <a class="addthis_counter"></a>
  </div-->
</div>
</div>
<div id="layout-content-box">
<div id="layout-banner">
  <div id="layout-title">在電梯裡遇見雙胞胎</div>
  <div id="layout-description">腦袋不是用來裝東西，而是用來思考問題的；所以我把懶得記的、記不住的，通通寫在這裡... <!--a href="http://www.diigo.com" onclick="var s=document.createElement('script');s.type='text/javascript';s.src='http://www.diigo.com/javascripts/webtoolbar/diigolet_b_h_b.js';document.body.appendChild(s);return false;"><img style="border:none" alt="Add to Diigo" src="http://www.diigo.com/images/diigo-icon/16.png" /></a--></div>
</div>
<div id="layout-content">
<div id="header">
<h1>SIKULI Basics</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_基本操作">基本操作</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
畫面左側提供常用的 Command List。照相機圖示代表接受 screenshot 做為參數，最下方的 Auto Capture 被勾選時，表示插入某個 function 時，要自動進入 capturing mode。
</p>
</li>
<li>
<p>
抓圖的方法：
</p>
<div class="ulist"><ul>
<li>
<p>
利用主畫面上方的 Take screenshot。可以搭配 Preferences&#8230; &gt; Screen Capturing &gt; Delay before capture 的設定，按下 Take screenshot 的數秒之後才會進入 capturing mode。
</p>
</li>
<li>
<p>
利用 Preferences&#8230; &gt; Screen Capturing &gt; Quick capture hotkey 所設定快捷鍵（預設是 Ctrl/Command+Shift+2）。要注意的是，快捷鍵按下去總是立即切換到 capturing mode，不受 Delay before capture 設定的影響。
</p>
</li>
<li>
<p>
實驗發現在 capturing mode 下，有些畫面還是抓不到，例如 Ubuntu 系統選單或應用程式的右鍵選單被帶出來時，快捷鍵會起不了作用，或是選單會因為按下快捷鍵而消失。這個時候可以考慮採用其他第三方的抓圖工具，抓完圖之後再用主畫面上方的 Insert image 把圖插進來。
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>常用的幾個指令（global functions）：</p></div>
<div class="ulist"><ul>
<li>
<p>
Find
</p>
<div class="ulist"><ul>
<li>
<p>
<code>exists(screenshot)</code>
</p>
</li>
<li>
<p>
<code>find(screenshot)</code>，接受 <code>\t</code> 做為 Tab
</p>
</li>
<li>
<p>
<code>findAll(screenshot)</code>
</p>
</li>
<li>
<p>
<code>wait(screenshot)</code>
</p>
</li>
<li>
<p>
<code>waitVanish(screenshot)</code>
</p>
</li>
</ul></div>
</li>
<li>
<p>
Mouse Actions
</p>
<div class="ulist"><ul>
<li>
<p>
<code>click(screenshot)</code>，裡面隱含 <code>wait()</code> 的動作。
</p>
</li>
<li>
<p>
<code>doubleClick(screenshot)</code>
</p>
</li>
<li>
<p>
<code>rightClick(screenshot)</code>
</p>
</li>
<li>
<p>
<code>hover(screenshot)</code>
</p>
</li>
<li>
<p>
<code>dragDrop(screenshot1, screenshot2)</code>
</p>
</li>
</ul></div>
</li>
<li>
<p>
Keyboard Actions
</p>
<div class="ulist"><ul>
<li>
<p>
<code>type(text)</code>
</p>
</li>
<li>
<p>
<code>type(screenshot, text)</code>
</p>
</li>
<li>
<p>
<code>paste(text)</code>
</p>
</li>
<li>
<p>
<code>paste(screenshot, text)</code>
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>其他：</p></div>
<div class="ulist"><ul>
<li>
<p>
switchApp(<em>System Preferences.app</em>)
</p>
</li>
<li>
<p>
findAll("screenshot.png")
</p>
</li>
<li>
<p>
visual pattern
</p>
</li>
<li>
<p>
region, spatial operators - below(), nearby()
</p>
</li>
<li>
<p>
target offset, defaults to center of a pattern
</p>
<div class="ulist"><ul>
<li>
<p>
getCenter().offset(), getTarget().offset()
</p>
</li>
<li>
<p>
target 可以是 Pattern、String、Region、Match、Location
</p>
</li>
</ul></div>
</li>
<li>
<p>
target offset 跟 mouse pointer 移動的路徑有關，如果路徑上會滑過畫面上其他 element 造成一些變化的話，要注意 target offset 的選定才行。之前遇到的案例是 Apple &gt; About this Mac，最後卻點到 About Sikuli，因為 mouse pointer 移往 About this Mac "中間" 的過程式，滑過 Sikuli 導致 menu 切換過去。
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_調整_region">調整 Region</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
left()
</p>
</li>
<li>
<p>
right()
</p>
</li>
<li>
<p>
top()
</p>
</li>
<li>
<p>
bottom()
</p>
</li>
<li>
<p>
inside()
</p>
</li>
<li>
<p>
nearby()
</p>
</li>
</ul></div>
<div class="paragraph"><p>不支援兩個 region 的交集，或許可以用 rectangle 自己運算？</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_基本概念">基本概念</h2>
<div class="sectionbody">
<div class="paragraph"><p>Sikuli 最重要的四個概念是－Pattern、Region、Match、Location。</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_target">Target</h2>
<div class="sectionbody">
<div class="paragraph"><p>PSRML 指的就是 Pattern、String、Region、Match、Location。</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_pattern">Pattern</h2>
<div class="sectionbody">
<div class="paragraph"><p>Pattern 可以是 <code>Pattern</code>、圖檔檔名、或是單純的字串。</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_region">Region</h2>
<div class="sectionbody">
<div class="paragraph"><p>實務上通常不會直接建立 region，而是從 screen 找尋某個 pattern 開始&#8230;</p></div>
<div class="listingblock">
<div class="content">
<pre><code>match =</code></pre>
</div></div>
<div class="paragraph"><p>由於 Screen 跟 Macth 都是 Region</p></div>
<div class="paragraph"><p>Region 表示畫面上的某個（矩形）區域，內部只記錄該區域的左上角座標 (x, y) 跟大小 (w, h)，不管該區域內實際的內容是什麼。</p></div>
<div class="paragraph"><p>Region 支援下面幾種操作：</p></div>
<div class="paragraph"><p>拿到 region 後，可以對它進行下面幾種操作：</p></div>
<div class="sect2">
<h3 id="_code_highlight_seconds_code"><code>highlight([seconds])</code></h3>
<div class="paragraph"><p>用紅色的邊框在畫面上標示出 region 的位置跟大小，它並不會讓程式卡住。</p></div>
<div class="paragraph"><p>如果沒有給定 <em>seconds</em> 的話，該邊框要等另一個不帶參數的 <code>highlight()</code> 被呼叫時才會消失。也就是說，畫面上是有可能同時存在兩個 highlight 的。</p></div>
<div class="paragraph"><p>在程式的實作上，<code>Match</code> 跟 <code>Screen</code> 都是繼承自 <code>org.sikuli.script.Region</code>。</p></div>
<div class="ulist"><ul>
<li>
<p>
在 Linux 下不支援，會遇到 "[error] highlight does not work on Linux." 的錯誤。
</p>
</li>
<li>
<p>
常用的 <code>right()</code>、<code>left()</code>、<code>below()</code>、<code>above()</code> 等，結果並不包含原來的 range 在內，所以 below(10) 並不是原來的 height 加 10，而是最後的 range 是原 range 的下緣加 10。
</p>
</li>
<li>
<p>
<code>exists()</code> 也是傳回 Match，而非 boolean。
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://sikuli.org/docx/region.html">Region — Sikuli X 1.0 documentation</a>
</p>
</li>
<li>
<p>
<a href="http://sikuli.org/doc/java-x/org/sikuli/script/Region.html">Region (Javadoc of Sikuli Script)</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/sikuli/sikuli/blob/develop/sikuli-script/src/main/java/org/sikuli/script/Region.java">Region.java</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_match">Match</h2>
<div class="sectionbody">
<div class="paragraph"><p>事實上 Match 也是個 Region。</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://sikuli.org/docx/match.html">Match — Sikuli X 1.0 documentation</a>
</p>
</li>
<li>
<p>
<a href="http://sikuli.org/doc/java-x/org/sikuli/script/Match.html">Match (Javadoc of Sikuli Script)</a>
</p>
</li>
<li>
<p>
<a href="https://github.com/sikuli/sikuli/blob/develop/sikuli-script/src/main/java/org/sikuli/script/Match.java">Match.java</a>
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jython_api">Jython API</h2>
<div class="sectionbody">
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../../_asciidoc/images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="title">參考資料</div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://sikuli.org/docx/faq/000-can-i-do-xxx.html">Can I do X or Y or Z in Sikuli?</a> - 在 Python/Java 裡能做的事，基本上都可以在 Sikuli 裡做。
</p>
</li>
</ul></div>
</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_參考資料">參考資料</h2>
<div class="sectionbody">
<div class="openblock">
<div class="title">官方文件</div>
<div class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://sikuli.org/demo.shtml">Demo</a>
</p>
</li>
<li>
<p>
<a href="http://sikuli.org/docx/tutorials/index.html">Tutorials</a>
</p>
</li>
<li>
<p>
<a href="http://sikuli.org/docx/sikuli-script-index.html">Everything about Sikuli Script</a> - 其中 <code>Region</code>、<code>Match</code> 跟 <code>Screen</code> 是重點。
</p>
</li>
<li>
<p>
<a href="http://sikuli.org/docx/">Sikuli Documentation</a>
</p>
</li>
<li>
<p>
<a href="http://www.slideshare.net/vgod/practical-sikuli-using-screenshots-for-gui-automation-and-testing">Practical Sikuli: using screenshots for GUI automation and testing</a> （SIKULI 作者寫的）
</p>
</li>
</ul></div>
</div></div>
<div class="openblock">
<div class="title">其他文件</div>
<div class="content">
<div class="ulist"><ul>
<li>
<p>
<a href="http://www.scribd.com/doc/87618834/sikuli-detailed-Doc">SIKULI Detailed Document</a>
</p>
</li>
</ul></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_學習筆記">學習筆記</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
程式碼是代管在 <a href="https://launchpad.net/sikuli">LaunchPad</a>，但官網左上角還是有 Fork me on GitHub 的連結。
</p>
</li>
<li>
<p>
可以執行在 Windows/Linux/Mac OS X, or even an iphone or android application running in a simulator or via VNC.
</p>
</li>
<li>
<p>
SIKULI 除了在講專案時才用大寫，其他時候都慣用 Sikuli。例如 Projet SIKULI 及 Sikuli Script/IDE。
</p>
</li>
<li>
<p>
Sikuli Script 其實就是 Jython code (a visual scripting API for Jython)，因此如果 script 夠複雜的話，也可以切出 modules。像下面這段程式在 Sikuli IDE 直接執行是沒問題的。
</p>
<div class="listingblock">
<div class="content">
<pre><code>def main():
    if exists("1323829870428.png"):
        print "hello"
    else:
        print "no no.."

if __name__ == '__main__':
    main()</code></pre>
</div></div>
</li>
<li>
<p>
要操作的對象也是慣稱 <em>target</em>
</p>
</li>
<li>
<p>
進入 screen capturing mode 後螢幕不會暗掉，是因為 Remote Desktop 的關係嗎？按 Esc 可以跳出來。
</p>
</li>
<li>
<p>
<code>.sikuli</code> 是 source script，而 <code>.skl</code> 則是 executable script，由 <code>.sikuli</code> 匯出的二進位檔。
</p>
</li>
<li>
<p>
<code>.sikuli</code> 其實是個資料夾，裡面包含 <code>.py</code>, <code>.html</code> 與一些拍下來的圖檔，其中 <code>.html</code> 大概是為了方便那些沒有 IDE 的人方便檢視 script 吧？
</p>
</li>
<li>
<p>
<code>.py</code> 裡並沒有做 import 的動作，那 <code>exists</code> 這些 function 是怎麼來的？如何做到跟 Robot Framework 接軌之後還能用 Sikuli IDE 開起來做維護。
</p>
</li>
<li>
<p>
為什麼產品名現在改做 Sikuli X 1.0，其中 <em>X</em> 指的是什麼？
</p>
</li>
<li>
<p>
Sikuli IDE 裡的圖形，其實就是一個檔案的字串，所以可以做一些運算&#8230;
</p>
</li>
</ul></div>
</div>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'imsardine'; // required: replace example with your forum shortname
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2013-06-21 06:09:18 CST
</div>
</div>
</div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript" src="http://s.gravatar.com/js/gprofiles.js?ver=e"></script>
<script>jQuery(document).ready(function($){ Gravatar.init(); });</script>
<!--script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-50d9b63d0e6d1b63"></script-->
</body>
</html>
